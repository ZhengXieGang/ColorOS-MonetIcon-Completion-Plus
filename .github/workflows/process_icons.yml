name: Auto Process UX Icons

# è§¦å‘æ¡ä»¶
on:
  # å½“æ¨é€åˆ° main åˆ†æ”¯ï¼Œä¸” uxicons ç›®å½•ä¸‹æœ‰å˜åŒ–æ—¶è§¦å‘
  push:
    branches: [ "main" ]
    paths:
      - 'uxicons/**'
      - 'process_icons.py'
  # å…è®¸æ‰‹åŠ¨åœ¨ Actions é¡µé¢ç‚¹å‡»æŒ‰é’®è§¦å‘
  workflow_dispatch:

# æƒé™è®¾ç½®ï¼šå…è®¸ Workflow å†™å…¥ä»£ç ä»“åº“ï¼ˆæäº¤æ›´æ”¹ï¼‰
permissions:
  contents: write

jobs:
  process-icons:
    runs-on: ubuntu-latest
    
    steps:
      # 1. æ£€å‡ºä»£ç 
      - name: Checkout repository
        uses: actions/checkout@v4
        
      # 2. è®¾ç½® Python ç¯å¢ƒ
      - name: Set up Python
        uses: actions/setup-python@v5
        with:
          python-version: '3.10' 
          
      # 3. å®‰è£…ä¾èµ– (Pillow)
      - name: Install dependencies
        run: |
          python -m pip install --upgrade pip
          pip install Pillow

      # 4. è¿è¡Œä½ çš„ Python è„šæœ¬
      - name: Run processing script
        run: python process_icons.py

      # 5. æäº¤å¹¶æ¨é€æ›´æ”¹ (å¦‚æœæ–‡ä»¶è¢«ä¿®æ”¹)
      - name: Commit and Push changes
        run: |
          # é…ç½® Git ç”¨æˆ·ä¿¡æ¯ï¼ˆä½¿ç”¨ GitHub Actions æœºå™¨äººï¼‰
          git config --global user.name "github-actions[bot]"
          git config --global user.email "41898282+github-actions[bot]@users.noreply.github.com"
          
          # æ·»åŠ  uxicons ç›®å½•ä¸‹çš„æ‰€æœ‰æ›´æ”¹
          git add uxicons/
          
          # æ£€æŸ¥æ˜¯å¦æœ‰æ–‡ä»¶çŠ¶æ€æ”¹å˜
          if git diff --staged --quiet; then
            echo "âœ… No changes to commit."
          else
            echo "ğŸ“ Changes detected, committing..."
            git commit -m "ğŸ¨ Auto-process icons: Rename & Fix RGBA [skip ci]"
            git push
          fi
